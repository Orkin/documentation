---
last_modified_on: "2022-11-18"
$schema: "/.meta/.schemas/guides.json"
title: "Grafana setup with Qovery"
description: "Easily setup Grafana with Qovery"
author_github: https://github.com/deimosfr
tags: ["type: tutorial", "technology: qovery"]
hide_pagination: true
---
import Jump from '@site/src/components/Jump';
import Alert from '@site/src/components/Alert';
import Assumptions from '@site/src/components/Assumptions';

[Grafana](https://grafana.com/grafana/) is a famous Open Source solution to observe graphs and logs, supporting many data sources.

This tutorial explains how to install Grafana on Qovery, and you will see how easy it is.

<!--
     THIS FILE IS AUTOGENERATED!

     To make changes please edit the template located at:

     website/guides/tutorial/grafana-install.md.erb
-->

## Grafana setup

First of all, create a project and an environment. Then let's create Grafana application.

<Alert type="info">

At the moment, Qovery does not support configuration file injection into Docker. So it can't be connected to an external database.
The currently used database is stored on the volume, so data will be lost on an application deletion. Qovery is going to implement configuration files for Docker in the coming weeks

</Alert>

### Create a Grafana application

Connect to the console and add a new application:

<p Valign="center">
  <img src="/img/grafana/qovery_create_app.png" alt="create gafana app" />
</p>

1. Set an application name
2. Select the application source type: Container registry
3. Select DockerHub Public (or the one you have. If you do not have one, create a registry pointing to DockerHub)
4. Set the image name: grafana/grafana
5. Take a look at the latest [Grafana tags](https://hub.docker.com/r/grafana/grafana/tags) and set the tag you want to use (do not use latest one to avoid later issues)

Then set the resources to 1 instance and let other default values (Grafana doesn't consume a lot of resources):

<p Valign="center">
  <img src="/img/grafana/qovery_set_resources.png" alt="set resources" />
</p>

Add a port mapping to the application, and set it to `3000`:

<p Valign="center">
  <img src="/img/grafana/qovery_set_port.png" alt="set port" />
</p>

Finally, click on the `Create` button:

<p Valign="center">
  <img src="/img/grafana/qovery_create.png" alt="create app" />
</p>

### Configure database storage

We're now going to create a volume that will contain Grafana default database:

<p Valign="center">
  <img src="/img/grafana/qovery_volume.png" alt="create app" />
</p>

Go into Settings > Storage > Add Storage. Set the `Path` to `/var/lib/grafana` and the `Size` to `4Gi`. Click on `Create`.

## Usage

Now you can deploy Grafana :). On the top right, you have the `Open links` button which will help you to get quick access. Then connect with those credentials:
* Login: admin
* Password: admin

<Alert type="warning">

Update the default password with a strong one as it is publicly exposed.

</Alert>

## Cloudwatch Datasource

You can add several data sources to Grafana. One we recommend at Qovery for full-text search is Cloudwatch. First of all, you have to [follow this guide][guides.tutorial.cloudwatch-integration] to ensure all your logs are sent to Cloudwatch. Then, you can add a new data source in Grafana:

<p Valign="center">
  <img src="/img/grafana/grafana_cloudwatch.png" alt="grafana cloudwatch" />
</p>

We advise you to use `assume role` or use a dedicated service account in read-only to access your logs. In this case, those permissions will be required:


```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "AllowReadingLogsFromCloudWatch",
      "Effect": "Allow",
      "Action": [
        "logs:DescribeLogGroups",
        "logs:GetLogGroupFields",
        "logs:StartQuery",
        "logs:StopQuery",
        "logs:GetQueryResults",
        "logs:GetLogEvents"
      ],
      "Resource": "*"
    },
    {
      "Sid": "AllowReadingTagsInstancesRegionsFromEC2",
      "Effect": "Allow",
      "Action": ["ec2:DescribeTags", "ec2:DescribeInstances", "ec2:DescribeRegions"],
      "Resource": "*"
    },
    {
      "Sid": "AllowReadingResourcesForTags",
      "Effect": "Allow",
      "Action": "tag:GetResources",
      "Resource": "*"
    }
  ]
}
```

More info: https://grafana.com/docs/grafana/latest/datasources/aws-cloudwatch/

Once done, you're able to create dashboards using Cloudwatch datasource and perform queries to your logs.

## Links
* [Add Cloudwatch support to Grafana](https://grafana.com/docs/grafana/v9.0/setup-grafana/configure-docker/#configure-aws-credentials-for-cloudwatch-support)
* [Grafana configuration for AWS](https://grafana.com/docs/grafana/latest/datasources/aws-cloudwatch/)


[guides.tutorial.cloudwatch-integration]: /guides/tutorial/cloudwatch-integration/
